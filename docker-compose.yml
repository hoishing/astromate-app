services:
  astromate-app:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: ${CONTAINER_NAME}
    ports:
      - "${STREAMLIT_PORT}:${STREAMLIT_PORT}"
    environment:
      - STREAMLIT_SERVER_PORT=${STREAMLIT_PORT}
      - STREAMLIT_SERVER_HEADLESS=true
    volumes:
      - .:/app
      - /app/.venv # Exclude virtual environment from volume mount
    working_dir: /app
    restart: unless-stopped
    command:
      [
        "uv",
        "run",
        "streamlit",
        "run",
        "main.py",
        "--server.port=${STREAMLIT_PORT}",
        "--server.address=0.0.0.0",
      ]
